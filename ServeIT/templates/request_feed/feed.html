<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <title>{{ title }}</title>
    <meta charset="UTF-8" />

    <!-- Boxicons CDN Link -->
    <link
      href="https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css"
      rel="stylesheet"
    />
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65"
      crossorigin="anonymous"
    />
    <link rel="stylesheet" href={{url_for('static',
    filename='css/feed.css' )}} />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  </head>

  <body>
    {% include 'sidebar.html' %}
    <div class="dashboard-section">
      {% include 'usernavbar.html' %}
      <div class="container mt-4">
        <div class="row p-2">
          <div class="col-6">
            <div class="card TR-card border-0">
              <div class="d-flex align-items-center m-3">
                <div class="TR-number ms-1 me-2">
                  <h3 >
                    {{ rq }}
                  </h3>
                </div>
                <div class="TR-info me-md-auto">
                  <h3 >
                    Total Request
                  </h3>
                </div>
              </div>
              </a>
            </div>
          </div>
          <div class="col-6">
            <div class="card TR-card border-0">
              <div class="d-flex align-items-center m-3">
                <div class="TR-number ms-1 me-2">
                  <h3 >
                    {{ cr }}
                  </h3>
                </div>
                <div class="TR-info me-md-auto">
                  <h3 >
                    Created Request
                  </h3>
                </div>
              </div>
              </a>
            </div>
          </div>
        </div>
        <div class="card RF-card">
          <div class="card-body">
          <div class="row RF-card-header my-3 ms-1">
            <h3>Request Feed</h3>
          </div>
          <div class="row RF-card-categories">
            <div class="col d-flex categories mx-2">
              <h5 class="mx-2">All</h5>
              <h5 class="mx-2">Print Request</h5>
              <h5 class="mx-2">Gcash Request</h5>
              <h5 class="mx-2">Food Request</h5>
            </div>
          </div>
          {% for request in rqlist %}
          {% if request['user_id'] or request['accepted_user_id'] == user['user_id'] %}
          <div class="row RF-card-requests p-2" >
            <div class="col-5 col-lg-8" >
            {% if request['service_name'] == 'SFPR'%}
              <div class="row requests-title mt-2"> 
                <h4>Printing Request</h4>
              </div>
            {% elif request['service_name'] == 'SFGC' %}
              <div class="row requests-title mt-2"> 
                <h4>Gcash Request</h4>
              </div>
            {% elif request['service_name'] == 'SFFDS' %}
              <div class="row requests-title mt-2"> 
                <h4>Food Request</h4>
              </div>
            {% else %}
              <div class="row requests-title mt-2">
                <h5>Hatdog ka?</h5>
              </div>
            {% endif %}
              <div class="row request-info ">
                <h5>{{ request['request_id'] }} - {{ request['location'] }}</h5>
              </div>
              <div class="row request-description">
                <h6>{{ request['description'] }} </h6>
              </div>
            </div>
              {% if request['user_id'] or request['accepted_user_id'] == user['user_id'] %}
              <div class="col-7 col-lg-4 d-flex justify-content-center align-self-center" >
                {% if request['order_status'] == 'Listing' %}
                <button type="button" class="btn accept-request " disabled>
                  Listing
                </button>
                {% elif request['order_status'] == 'Accepted' %}
                <button type="button" class="btn accept-request " disabled>
                  Accepted
                </button>
                {% else %}
                <button type="button" class="btn accept-request " disabled>
                  Completed
                </button>
                {% endif %}
              </div>  
              {% else %}
              <div class="col-7 col-lg-4 d-flex justify-content-center align-self-center" >
                <form action="{{ url_for('bp_dashboard.accept_request') }}" method="POST">
                  <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
                    <button type="submit" name="accept" value="{{ request['request_id'] }}" class="btn accept-request mx-2">
                      Accept
                    </button>
                    <button type="submit" name="bookmark" value="bookmark" class="btn bookmark-request">
                      <img src={{url_for('static', filename='img/icons/R_bookmark.png')}} alt="bookmark">
                    </button>
                </form>
              </div>
              {% endif %}
          </div>
          {% endif %}
        {% endfor %}
          </div>
        </div>
      </div>
    </div>
  </body>
  <script
    src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.min.js"
    integrity="sha384-cuYeSxntonz0PPNlHhBs68uyIAVpIIOZZ5JqeqvYYIcEL727kskC66kF92t6Xl2V"
    crossorigin="anonymous"
  ></script>
  <script defer>
    let sidebar = document.querySelector(".sidebar");
    let closeBtn = document.querySelector("#btn");
    closeBtn.addEventListener("click", () => {
      sidebar.classList.toggle("open");
      console.log(btn1);
      console.log(sidebar);
      console.log(sidebar.classList);
    });
  </script>
</html>
